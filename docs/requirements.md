# ドキュメント管理システム 要件定義書

## 1. 概要

本システムは、ユーザーがドキュメント（PDF, 画像, Office ファイルなど）をアップロード・管理・検索できる Web アプリケーションである。  
バックエンドは Spring Boot を採用し、フロントエンドは React によって構築する。  
システムはオブジェクトストレージ（MinIO）、メッセージキュー（ElasticMQ）、データベースマイグレーション管理（Flyway）を利用し、将来的な拡張性と可用性を考慮した設計とする。

---

## 2. システム構成

### フロントエンド

- 技術: React + TypeScript
- UI ライブラリ: Material UI または Chakra UI
- API 通信: axios (REST API 呼び出し)
- 認証: JWT を使用

### バックエンド

- 技術: Java 17 + Spring Boot
- API: REST API
- データベース: PostgreSQL
- マイグレーション: Flyway
- ストレージ: MinIO (Amazon S3 互換)
- メッセージキュー: ElasticMQ (Amazon SQS 互換)

---

## 3. 機能要件

### 3.1 ユーザー管理

- ユーザー登録、ログイン、ログアウト
- JWT による認証
- 権限（一般ユーザー / 管理者）

### 3.2 ドキュメント管理

- ドキュメントのアップロード（MinIO に保存）
- ドキュメントのダウンロード
- メタデータの管理（タイトル、タグ、アップロード日時、ユーザー情報）
- バージョン管理（同一ファイル名での更新時）

### 3.3 検索・閲覧

- タイトル・タグ・ユーザーによる検索
- アップロード履歴の閲覧

### 3.4 非同期処理

- アップロード後に ElasticMQ に処理をキューイング
  - サムネイル生成
  - テキスト抽出（将来的な全文検索機能のため）
- 非同期処理結果を DB に反映

---

## 4. 非機能要件

- セキュリティ: JWT による認証、ファイルアクセス制御
- 可用性: ローカル環境では Docker Compose により MinIO・ElasticMQ・DB を起動可能にする
- 保守性: Flyway により DB スキーマのバージョン管理を行う
- 拡張性: 本番環境では AWS S3 / SQS への移行が可能

---

## 5. 想定ユースケース

1. ユーザーがログインする
2. ドキュメントをアップロードする
3. アップロード後、ElasticMQ に「処理ジョブ」が送信される
4. バックエンドのワーカーがサムネイル生成やテキスト抽出を行い、結果を DB に保存する
5. ユーザーはフロントエンドから検索してファイルを閲覧・ダウンロードできる

---

## 6. 開発環境

- バックエンド: Spring Boot, Java 17, Gradle
- フロントエンド: React 18, TypeScript
- DB: PostgreSQL + Flyway
- ストレージ: MinIO (ローカル開発時)
- キュー: ElasticMQ (ローカル開発時)
- コンテナ管理: Docker Compose

---

## 7. 将来的な拡張

- AWS 環境へのデプロイ（S3, SQS, RDS, ECS）
- フルテキスト検索機能（Elasticsearch 連携）
- ドキュメント共有機能（外部リンク発行）
- チーム管理機能（グループごとのアクセス制御）

---
